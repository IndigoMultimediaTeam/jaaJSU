<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Documentation: jaaJSU@0.1.4</title>
    <link rel="stylesheet" href="../assets/from_yahhoapis/cssgrids-min.css">
<link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="../assets/from_yahhoapis/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png" width="117" height="52">jaaJSU</a>: src\special_functions\$dom_add_helpers_cordova.sub.js</h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.4</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Modules</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../modules/jaaJSU.{global}.html">jaaJSU.{global}</a>
                            </li>
                    </ul>
                </div>
            </div>
            
            <div id="classes" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Classes</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../classes/$array.{namespace}.html">$array.{namespace}</a></li>
                            <li><a href="../classes/$async.{namespace}.html">$async.{namespace}</a></li>
                            <li><a href="../classes/$dom.{namespace}.html">$dom.{namespace}</a></li>
                            <li><a href="../classes/$function.{namespace}.html">$function.{namespace}</a></li>
                            <li><a href="../classes/$object.{namespace}.html">$object.{namespace}</a></li>
                            <li><a href="../classes/$optimizier.{namespace}.html">$optimizier.{namespace}</a></li>
                            <li><a href="../classes/$string.{namespace}.html">$string.{namespace}</a></li>
                            <li><a href="../classes/$time.{namespace}.html">$time.{namespace}</a></li>
                    </ul>
                </div>
            </div>
            
            <div id="elements" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Elements</h2>
                </div>
                <div class="bd">
                    <ul>
                    </ul>
                </div>
            </div>
            
            
            
            
            
            <div id="fileTree" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Files</h2>
                </div>
                <div class="bd">
                    <ul><li>src\jaaJSU.js/<ul></ul></li><li>src\namespaces\$array.sub.js/<ul></ul></li><li>src\namespaces\$async.sub.js/<ul></ul></li><li>src\namespaces\$dom.sub.js/<ul></ul></li><li>src\namespaces\$function.sub.js/<ul></ul></li><li>src\namespaces\$object.sub.js/<ul></ul></li><li>src\namespaces\$optimizier.sub.js/<ul></ul></li><li>src\namespaces\$string.sub.js/<ul></ul></li><li>src\namespaces\$time.sub.js/<ul></ul></li><li>src\special_functions\$dom_add_helpers_cordova.sub.js/<ul></ul></li><li>src\special_functions\$dom_add_helpers_standalone.sub.js/<ul></ul></li><li>src\special_functions\$dom_forceRedraw_cordova.sub.js/<ul></ul></li><li>src\special_functions\$dom_forceRedraw_standalone.sub.js/<ul></ul></li></ul>
                </div>
            </div>
            
        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>src\special_functions\$dom_add_helpers_cordova.sub.js</h4>

<pre class="code prettyprint linenums">
/* jshint esversion: 6,-W097, -W040, browser: true, expr: true, undef: true */
/* core.js *//* global parseHTML, c_CMD, active_page, __internal_switch_values_holder *///gulp.keep.line
/* $dom *//* global $dom */
/**
 * This is syntax sugar around [&#x60;DocumentFragment&#x60;](https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment) for creating DOM components and their adding to live DOM in performance friendly way.
 * @method component [cordova]
 * @for $dom.{namespace}
 * @param {String} el_name
 *  - Name of element (for example &#x60;LI&#x60;, &#x60;P&#x60;, &#x60;A&#x60;, ...).
 *  - This is parent element of component.
 * @param {Object} attrs
 *  - The second argument for [$dom.assign](#methods_assign)
 * @returns {Object}
 *  - &#x60;c.add(el_name, attrs, shift= 0)&#x60; **{Function}**
 *      - This method add child element into **parent**
 *      - &#x60;el_name&#x60; **{String}**: Name of element (for example &#x60;LI&#x60;, &#x60;P&#x60;, &#x60;A&#x60;, ...).
 *      - &#x60;attrs&#x60; **{Object}**: The second argument for [$dom.assign](#methods_assign)
 *      - &#x60;[shift= 0]&#x60; **{Number}**: Modify nesting behaviur. By default (&#x60;shift= 0&#x60;), new element is child of previus element. Every &#x60;-1&#x60; means moving to the upper level against current one - see example.
 *  - &#x60;c.component(c, shift= 0)&#x60; **{Function}**
 *      - &#x60;c&#x60; **{Object}**: It schould be at minimum function &#x60;mount&#x60; from &#x60;$dom.component(*)&#x60;. But prefered way is to use &#x60;c.share&#x60; see later.
 *      - &#x60;[shift= 0]&#x60; **{Number}**: Modify nesting behaviur. By default (&#x60;shift= 0&#x60;), new element is child of previus element. Every &#x60;-1&#x60; means moving to the upper level against current one - see example.
 *  - &#x60;c.share&#x60; **{Object}**
 *      - This is export for using in another &#x60;$dom.component(*)&#x60; by calling its &#x60;c.component&#x60;.
 *  - &#x60;c.mount(parent, [call_parseHTML=false], [type= &quot;end&quot;])&#x60; **{Function}**
 *      - This append commponent to the &#x60;parent&#x60; node.
 *      - &#x60;parent&#x60; **{NodeElement}**: Where to place component
 *      - &#x60;[call_parseHTML=false]&#x60; {Boolean}: If **true** calls &#x60;parseHTML(parent.querySelectorAll(c_CMD))&#x60;
 *      - &#x60;[type= &quot;end&quot;]&#x60; **{String}**: By default place component as last child. By using &#x60;type= &quot;start&quot;&#x60; place component as first child.
 *      - **Returns {NodeElement}**: Component wrapper initialized by &#x60;$dom.component(*)&#x60;
 * @example
 *      //#1
 *      const UL= document.getElementById(&#x27;SOME UL&#x27;);
 *      const { add, share: { mount } }= $dom.component(&quot;LI&quot;, { className: &quot;list_item&quot; });//&lt;li class=&quot;list_item&quot;&gt;...&lt;/li&gt;
 *      add(&quot;DIV&quot;, { textContent: &quot;Child of .list_item&quot;, className: &quot;deep1&quot; });//&lt;li class=&quot;list_item&quot;&gt;&lt;div class=&quot;deep1&quot;&gt;...&lt;/div&gt;&lt;/li&gt;
 *          add(&quot;DIV&quot;, { textContent: &quot;Child of div.deep1&quot;, className: &quot;deep2&quot; });//...&lt;div class=&quot;deep1&quot;&gt;&lt;div class=&quot;deep2&quot;&gt;...&lt;/div&gt;&lt;/div&gt;...
 *              add(&quot;DIV&quot;, { textContent: &quot;Child of div.deep2&quot;, className: &quot;deep3&quot; });//...&lt;div class=&quot;deep1&quot;&gt;&lt;div class=&quot;deep2&quot;&gt;&lt;div class=&quot;deep3&quot;&gt;...&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;...
 *              add(&quot;DIV&quot;, { textContent: &quot;Child of div.deep2&quot;, className: &quot;deep3 mark&quot; }, -1);//...&lt;div class=&quot;deep2&quot;&gt;&lt;div class=&quot;deep3&quot;&gt;...&lt;/div&gt;&lt;div class=&quot;deep3&quot;&gt;...&lt;/div&gt;&lt;/div&gt;...
 *      //next add(*) schoul be child of div.deep3.mark, by -1 it is ch.of div.deep2, by -2 ch.of div.deep1, by -3 ch.of li.list_item because div.deep3.mark is on 3rd level
 *          add(&quot;DIV&quot;, { textContent: &quot;Child of div.deep1&quot;, className: &quot;deep2 nextone&quot; }, -2);//this is on 2nd level
 *      add(&quot;DIV&quot;, { textContent: &quot;Child of div.deep1&quot;, className: &quot;deep2 nextone&quot; }, -2);//this is on 0 level
 *      mount(UL);
 *      //FINAL RESULT
 *      //&lt;ul id=&quot;SOME UL&quot;&gt;&lt;li&gt;
 *      //    &lt;div class=&quot;deep1&quot;&gt;
 *      //        Child of .list_item
 *      //        &lt;div class=&quot;deep2&quot;&gt;
 *      //            Child of div.deep1
 *      //            &lt;div class=&quot;deep3&quot;&gt;Child of div.deep2&lt;/div&gt;
 *      //            &lt;div class=&quot;deep3 mark&quot;&gt;Child of div.deep2&lt;/div&gt;
 *      //        &lt;/div&gt;
 *      //        &lt;div class=&quot;deep2 nextone&quot;&gt;Child of div.deep1&lt;/div&gt;
 *      //    &lt;/div&gt;
 *      //    &lt;div class=&quot;deep1 nextone&quot;&gt;
 *      //        Child of div.deep1&lt;/div&gt;
 *      //&lt;/li&gt;&lt;/ul&gt;
 */
$dom.component= function(el_name, attrs){
    const fragment= document.createDocumentFragment();
    let els= [], all_els_counter= 0, deep= [];
    add(el_name, attrs);
    const share= { mount };
    return { add, component, share };
    
    function add(el_name, attrs, shift= 0){
        recalculateDeep(shift);
        attrs= attrs || {};
        const prepare_el= document.createElement(el_name);
        if(!all_els_counter) els[0]= fragment.appendChild(prepare_el);
        else els[all_els_counter]= els[getParentIndex()].appendChild(prepare_el);
        let el= els[all_els_counter];
        all_els_counter++;
        $dom.assign(el, attrs);
        return el;
    }
    function component({ mount }, shift= 0){
        recalculateDeep(shift);
        els[all_els_counter]= mount(els[getParentIndex()]);
        all_els_counter+= 1;
    }
    function mount(parent, call_parseHTML= false, type= &quot;end&quot;){
        if(type===&quot;top&quot; &amp;&amp; parent.childNodes.length) parent.insertBefore(fragment, parent.childNodes[0]);
        else parent.appendChild(fragment);
        if(call_parseHTML) parseHTML(parent.querySelectorAll(c_CMD));
        return els[0];
    }
    function recalculateDeep(shift){
        if(!shift) deep.push(all_els_counter);
        else { deep.splice(deep.length+1+shift); deep[deep.length-1]= all_els_counter; }
    }
    function getParentIndex(){
        return deep[deep.length-2];
    }
};
/**
 * See [add](#methods_add)
 * @method add [cordova]
 * @for $dom.{namespace}
 * @param parent {NodeElement}
 * @param $$$ {...Array}
 *  * Works also with &quot;jsif_var&quot; and/or &quot;data-cmd=&#x27;condition-changeval&#x27;&quot; see [$dom.assign \[cordova\]](#methods_$dom.assign [cordova])
 * @param [call_parseHTML=undefined] {Boolean}
 *  * If **true** calls &#x60;parseHTML(parent.querySelectorAll(c_CMD))&#x60;
 * @return {NodeElement}
 *  * First created element (usualy wrapper thanks nesting)
 */
$dom.add= function(parent,$$$, call_parseHTML){
    let fragment= document.createDocumentFragment();
    let prepare_els= [], els= [];
    for(var i=0, i_length= $$$.length; i&lt;i_length;i++){
        prepare_els[i]= document.createElement($$$[i][0]);
        if(!i) els[i]= fragment.appendChild(prepare_els[i]);
        else if(typeof $$$[i][1].$!==&quot;undefined&quot;){
            els[i]= els[$$$[i][1].$].appendChild(prepare_els[i]);
            delete $$$[i][1].$;
        }
        else els[i]= els[i-1].appendChild(prepare_els[i]);
        $dom.assign(els[i], $$$[i][1]);
    }
    parent.appendChild(fragment);
    if(call_parseHTML) parseHTML(parent.querySelectorAll(c_CMD));
    if(i) return els[0];
};
/**
 * Procedure for merging object into the element properties. See [$dom.assign](#methods_assign).
 * Very simple example: &#x60;$dom.assign(document.body, { className: &quot;test&quot; });&#x60; is equivalent to &#x60;document.body.className= &quot;test&quot;;&#x60;.
 * @method assign [cordova]
 * @for $dom.{namespace}
 * @param {NodeElement} element
 * @param {Object} object_attributes
 *  - there is also supprot for &quot;jsif_var&quot; and/or &quot;data-cmd=&#x27;condition-changeval&#x27;&quot;
 * @example
 *      const el= document.body;
 *      const onclick= function(){ console.log(this.dataset.js_param); };
 *      $dom.assign(el, { textContent: &quot;BODY&quot;, style: &quot;color: red;&quot;, dataset: { js_param: &quot;CLICKED&quot; }, onclick });
 *      //result HTML: &lt;body style=&quot;color: red;&quot; data-js_param=&quot;CLICKED&quot;&gt;BODY&lt;/body&gt;
 *      //console output on click: &quot;CLICKED&quot;
 */
$dom.assign= function(element, object_attributes){
    const object_attributes_keys= Object.keys(object_attributes);
    for(let i=0, key, attr, i_length= object_attributes_keys.length; i&lt;i_length; i++){
        key= object_attributes_keys[i];
        attr= object_attributes[key];
        switch(key){
            case &quot;style&quot;:
                element.setAttribute(&quot;style&quot;, attr);
                break;
            case &quot;style_vars&quot;:
                for(let k=0, k_key, k_keys= Object.keys(attr), k_length= k_keys.length; k&lt;k_length; k++){ k_key= k_keys[k]; element.style.setProperty(k_key, attr[k_key]); }
                break;
            case &quot;dataset&quot;:
                for(let k=0, k_key, k_keys= Object.keys(attr), k_length= k_keys.length; k&lt;k_length; k++){
                    k_key= k_keys[k];
                    if(k_key===&quot;jsif_var&quot;&amp;&amp;element.dataset.cmd!==&quot;condition-changeval&quot;) element.dataset.jsif_eq= attr.jsif_val.indexOf(__internal_switch_values_holder.get(active_page+attr.jsif_var)) !== -1;
                    element.dataset[k_key]= attr[k_key];
                }
                break;
            case &quot;href&quot; || &quot;src&quot; || &quot;class&quot;:
                element.setAttribute(key, attr);
                break;
            default:
                element[key]= attr;
                break;
        }
    }
};
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>

</body>
</html>
